Bootstrap: docker
From: maladmin/jessie-dtiprep:latest

%setup
	echo "Installing runscript"
	cp dtiprep.py ${SINGULARITY_ROOTFS}/opt/dtiprep.py
	cp environment ${SINGULARITY_ROOTFS}/environment
	exit 0

%post
	echo "Making dtiprep.py runnable"
	chmod 755 /opt/dtiprep.py

	mkdir /input
	mkdir /output
	exit 0

%runscript
	if [ -z $1 ]
		then
			echo "DTIPrep Container"
			echo "USAGE:"
			echo "singularity run <container> -B <nrrd_inputfolder>:/input/nrrd -B <nifiti_inputfolder>:/input/nii -B <outputfolder>:/output <subject_id>"
			exit 1
	fi
	echo "Arguments received: $*"

	echo "Running DTIPrep"
	/opt/dtiprep.py "$1"
